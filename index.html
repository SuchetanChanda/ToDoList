<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
      integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2"
      crossorigin="anonymous"
    />

    <title>TODOs List</title>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <a class="navbar-brand" href="index.html">TODOs List</a>
      <button
        class="navbar-toggler"
        type="button"
        data-toggle="collapse"
        data-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <form>
          <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
              <a class="nav-link" href="index.html"
                >Home <span class="sr-only">(current)</span></a
              >
            </li>
            <li class="nav-item active">
              <a class="nav-link" href="aboutUs.html"
                >About Me<span class="sr-only">(current)</span></a
              >
            </li>
          </ul>
        </form>
      </div>
    </nav>
    <div class="p-5">
      <h2 class="text-center my-4">TODOs List</h2>
      <div class="form-group">
        <label for="text">Title:</label>
        <input
          type="text"
          class="form-control"
          id="title"
          aria-describedby="emailHelp"
        />
        <small id="emailHelp" class="form-text text-muted"
          >Add your task here.</small
        >
      </div>
      <div class="form-group">
        <label for="comment">Description:</label>
        <textarea class="form-control" rows="5" id="desc"></textarea>
      </div>
      <button id="add" type="submit" class="btn btn-primary">Add</button>
      <button id="clear" class="btn btn-warning" onclick="confirmClear()">
        Clear List
      </button>
      <div>
        <h2 class="text-center my-4">TASKS REMAINING:</h2>
        <table class="table table-striped table-dark">
          <thead>
            <tr>
              <th scope="col">SL no.</th>
              <th scope="col">Title</th>
              <th scope="col">Description</th>
              <th scope="col">Action</th>
            </tr>
          </thead>
          <tbody id="table">
            <tr>
              <th scope="row"></th>
              <td>No tasks remaining.</td>
              <td></td>
              <td><button class="btn btn-sm btn-danger"></button></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <!-- Footer -->
    <footer class="page-footer font-small blue">
      <!-- Copyright -->
      <div class="footer-copyright text-center py-3 absolute-bottom">
        Â© 2022 Copyright:
        <a
          href="https://suchetanchanda.github.io/portfolio/"
          target="_blank"
          rel="noopener noreferrer"
        >
          Suchetan Chanda</a
        >
      </div>
      <!-- Copyright -->
    </footer>
    <!-- Footer -->
    <script>
        
      function confirmClear() {
        let conf = confirm("Press ok to clear the List:");
        if (conf) {
          deleteAll();
        }
      }
      function getAndUpdate() {
        console.log("Clicked");
        title = document.getElementById("title").value;
        desc = document.getElementById("desc").value;
        //   console.log(desc);
        if (localStorage.getItem("items") == null) {
          itemsJSONArray = [];
          itemsJSONArray.push([title, desc]);
          localStorage.setItem("items", JSON.stringify(itemsJSONArray));
          tableBody.innerHTML=`<tr>
                    <th scope="row">No tasks remaining.</th>
                  </tr>`;
        } else {
          itemsJSONtring = localStorage.getItem("items");
          itemsJSONArray = JSON.parse(itemsJSONtring);
          itemsJSONArray.push([title, desc]);
          localStorage.setItem("items", JSON.stringify(itemsJSONArray));
        }
        update();
      }
      function update() {
        
        if (localStorage.getItem("items") == null) {
          itemsJSONArray = [];
          localStorage.setItem("items", JSON.stringify(itemsJSONArray));
          tableBody.innerHTML=`<tr>
                    <th scope="row">No tasks remaining.</th>
                  </tr>`;
        } else {
          itemsJSONtring = localStorage.getItem("items");
          itemsJSONArray = JSON.parse(itemsJSONtring);
          localStorage.setItem("items", JSON.stringify(itemsJSONArray));
        }

        // Populating the table
        // console.log(itemsJSONArray);
        tableBody = document.getElementById("table");
        let str = "";
        itemsJSONArray.forEach((element, index) => {
          // console.log(element[1]);
          str += `
                    <tr>
                    <th scope="row">${index + 1}</th>
                    <td >${element[0]}</td>
                    <td>${element[1]}</td>
                    <td><button class="btn btn-sm btn-danger" onclick="deleted(${index})">Delete</button> </td>
                  </tr>`;
        });
        tableBody.innerHTML = str;
      }
      add = document.getElementById("add");
      add.addEventListener("click", getAndUpdate);
      update();
      function deleted(itemIndex) {
        itemsJSONtring = localStorage.getItem("items");
        itemsJSONArray = JSON.parse(itemsJSONtring);
        itemsJSONArray.splice(itemIndex, 1);
        localStorage.setItem("items", JSON.stringify(itemsJSONArray));
        update();
      }
      //   clear = document.getElementById("clear");
      //   clear.addEventListener("click", conf=confirm("Do you want to clear the list?"));

      function deleteAll() {
        console.log("clearing");
        localStorage.clear();
        update();
      }
    </script>
  </body>
</html>
